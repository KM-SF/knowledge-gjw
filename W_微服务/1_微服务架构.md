
1. 为什么有微服务？单体架构 ==> 微服务
   1. 单体架构的缺陷
      1. 随着业务逻辑复杂度激增，服务之间耦合在一起，代码量大，很难维护
      2. 业务缠绕在一起，水平扩展很难
   2. 微服务架构的优势
      1. 按照服务拆分，解耦开，按照领域维护，简单
      2. ...
2. 微服务，会带来什么挑战？
   1. 本地事务 ==> 分布式事务
   2. 微服务治理
3. 设计微服务的基本原则
   1. AKF拆分原则
   2. 前后端分离
   3. 无状态服务
   4. Restful通信风格
4. 微服务拆分原则: DDD
   1. DDD概念
      1. 实体 = 唯一身份标识 + 可变性
      2. 值对象: 它没有ID，是实体的属性
      3. 聚合、聚合根
      4. 领域
   2. 领域划分方法论
      1. 多角色参与共同讨论有哪些“实体”，并用圈圈画出来
      2. 找到实体与实体之间的联系，并用虚线连线
      3. 多对多关系的实体必然是一个独立的领域，删除他们周围的连线
      4. 找到单独出现在系统中没有意义或者不能被正确理解的实体，用实线标识他们的关联关系
      5. 删除剩下的虚线，就得到了划分好的领域
   3. DDD指导Coding
      1. 接口层
         - web接口
         - cmd
         - cron
         - consumer
      2. Service层(领域层)
         - 业务逻辑
      3. 存储层
         - redis
         - mysql
         - message queue
         - ... ...
5. 微服务架构功能组成
   1. 服务注册与发现
   2. 服务监控与治理
      1. 限流、熔断、降级
      2. 重试
      3. 告警、模调、哈勃
      4. 调用全链路追踪
         1. 记录traceId、RPCId、调用的开始时间，调用类型，协议类型，调用方ip和端口，请求的服务名等信息
         2. 调用耗时，调用结果，异常信息，消息报文等
6. 微服务架构演变
   1. 最简单的RPC
   2. 服务中内置SDK，对代码有侵入
   3. service mesh(sidecar边车)
      1. service和sidecar-agent部署在一起
      2. sidecar提供微服务架构的功能，与service解耦开

 
 
 

